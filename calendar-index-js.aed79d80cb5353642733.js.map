{"version":3,"sources":["webpack:///./components/notification/index.js","webpack:///./utils/fetch-error.js","webpack:///./database/decorator.js","webpack:///./database/index.js","webpack:///./components/userRoles/index.js","webpack:///./components/calendar/index.js","webpack:///./components/logIn-modal/index.js","webpack:///./fixtures-members.js","webpack:///./pages/calendar/index.js"],"names":["message","status","toastTemplate","toastContainer","document","querySelector","wrapper","createElement","innerHTML","toastElement","firstElementChild","appendChild","toast","lastElementChild","bootstrap","Toast","animation","autohide","delay","show","setTimeout","remove","FetchError","Error","constructor","response","super","this","window","addEventListener","event","reason","alert","BACKEND_URL","process","SYSTEM","QueriesFactory","_instance","type","data","query","Response","define","fn","async","fetch","url","options","ok","statusText","showToast","console","error","getTry","args","apply","TypeError","get","method","result","json","dataResult","map","item","id","JSON","parse","isTimeSlotEmpty","some","day","time","post","headers","body","stringify","delete","instance","User","meetings","users","chosenMeeting","target","closest","chosenMeetingId","dataset","meeting","chosenMeetingName","name","confirm","sessionUser","sessionStorage","getItem","render","getTable","element","length","renderMeetings","subElements","getSubElements","initEventListeners","querySelectorAll","reduce","accum","subElement","getTableHeader","getTableBody","getTableFooter","rights","getMembersDropdown","getEventButton","membersList","user","join","canCreateMeetings","getTableHoursColumn","getTableColumn","a","i","start","end","duration","push","currentRow","canDeleteMeetings","deleteButton","button","onRemoveMeetingClick","membersDropdown","chosenMember","value","filterMeetings","clear","location","reload","Object","keys","style","visibility","idOfChosenMember","find","filteredMeetings","filter","members","every","member","includes","destroy","Admin","LogInModal","noMembersMock","Page","getMembers","getName","getRights","selectedIndex","getAttribute","memberLoggedInData","setItem","initComponents","renderComponents","template","responseUsers","responseEvents","getSessionUser","modal","logInModal","Modal","onDefineRights","calendar","components","forEach","component","root","append","values"],"mappings":"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","file":"calendar-index-js.aed79d80cb5353642733.js","sourcesContent":["export default (message = 'API response: succesful', status) => {\n  const toastDelay = 2000;\n\n  const toastTemplate = `\n    <div class=\"toast calendar__toast_${status} align-items-center\" role=\"alert\" aria-live=\"assertive\" aria-atomic=\"true\">\n      <div class=\"d-flex\">\n        <div class=\"toast-body\">\n          ${message}\n        </div>\n      </div>\n    </div>`;\n\n  const toastContainer = document.querySelector('.toast-container');\n\n  // tramsform toast template to html element\n  const wrapper = document.createElement('div');\n  wrapper.innerHTML = toastTemplate;\n  const toastElement = wrapper.firstElementChild;\n\n  toastContainer.appendChild(toastElement);\n\n  const toast = toastContainer.lastElementChild;\n  const toastRender = new bootstrap.Toast(toast, {\n    animation: true,\n    autohide: true,\n    delay: toastDelay,\n  });\n\n  toastRender.show();\n\n  setTimeout(() => {\n    toastContainer.firstElementChild.remove();\n  }, toastDelay);\n};\n","export default class FetchError extends Error {\n  name = 'FetchError';\n\n  constructor(response, message) {\n    super(message);\n    this.response = response;\n  }\n}\n\n// handle uncaught failed fetch through\nwindow.addEventListener('unhandledrejection', (event) => {\n  if (event.reason instanceof FetchError) {\n    alert(event.reason.message);\n  }\n});\n","import FetchError from '../utils/fetch-error';\nimport showToast from '../components/notification';\n\nfunction Catch(fn) {\n  return async function (...args) {\n    let response;\n\n    try {\n      response = await fn.apply(this, args);\n      return response;\n    } catch (error) {\n      if (error instanceof TypeError)\n        console.error(new FetchError(response, error));\n\n      setTimeout(() => {\n        showToast(\n          `API: something went wrong with getting ${this.data}`,\n          'error'\n        );\n      }, 100);\n    }\n  };\n}\n\nexport default Catch;\n","import showToast from '../components/notification';\nimport Catch from './decorator';\n\nconst BACKEND_URL = process.env.BACKEND_URL;\nconst SYSTEM = process.env.SYSTEM;\nconst ENTITY_EVENTS = process.env.ENTITY_EVENTS;\nconst ENTITY_USERS = process.env.ENTITY_USERS;\n\nclass Get {\n  constructor(data) {\n    this.data = data;\n    this.message = `${data} downloaded`;\n\n    if (data === 'users') {\n      this.url = `${BACKEND_URL}/${SYSTEM}/${ENTITY_USERS}`;\n    }\n    if (data === 'events') {\n      this.url = `${BACKEND_URL}/${SYSTEM}/${ENTITY_EVENTS}`;\n    }\n\n    this.options = {\n      method: 'GET',\n    };\n  }\n\n  async getTry(response) {\n    const result = await response.json();\n\n    const dataResult = await result.map((item) => ({\n      id: item.id,\n      data: JSON.parse(item.data),\n    }));\n\n    setTimeout(\n      () => showToast(`API: ${this.message} succesfully`, 'succesful'),\n      100\n    );\n\n    return dataResult;\n  }\n}\n\nclass Post {\n  constructor(data) {\n    this.data = data;\n    this.message = `${data} posted`;\n    this.url = `${BACKEND_URL}/${SYSTEM}/${ENTITY_EVENTS}`;\n    this.options = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json;charset=utf-8',\n      },\n      body: JSON.stringify({\n        data: JSON.stringify(data),\n      }),\n    };\n  }\n\n  async getTry() {\n    showToast('API: event posted succesfully', 'succesful');\n  }\n}\n\nclass Delete {\n  constructor(data) {\n    this.data = data;\n    this.url = `${BACKEND_URL}/${SYSTEM}/${ENTITY_EVENTS}/` + data;\n    this.options = {\n      method: 'DELETE',\n    };\n  }\n\n  async getTry(response) {\n    showToast(`API: event deleted succesfully`, 'succesful');\n\n    return response.ok;\n  }\n}\n\nclass IsTimeSlotEmpty {\n  constructor(data) {\n    this.data = data;\n    this.url = `${BACKEND_URL}/${SYSTEM}/${ENTITY_EVENTS}`;\n    this.options = {\n      method: 'GET',\n    };\n  }\n\n  async getTry(response) {\n    const result = await response.json();\n\n    if ((await result) === null) {\n      showToast('No data', 'warning');\n      return true;\n    }\n\n    const isTimeSlotFull = await result.some(\n      (item) =>\n        JSON.parse(item.data).day === this.data.day &&\n        JSON.parse(item.data).time === this.data.time\n    );\n\n    if (isTimeSlotFull) {\n      showToast(\n        'API: This time slot is already occupied. Please choose another day or time',\n        'warning'\n      );\n      return false;\n    }\n\n    return true;\n  }\n}\n\nclass QueriesFactory {\n  static instance() {\n    if (!this._instance) {\n      this._instance = new QueriesFactory();\n    }\n    return this._instance;\n  }\n\n  static response = {\n    get: Get,\n    isTimeSlotEmpty: IsTimeSlotEmpty,\n    post: Post,\n    delete: Delete,\n  };\n\n  /* this is the response body template for factory */\n  response(type, data) {\n    const Response = QueriesFactory.response[type];\n    const query = new Response(data);\n    query.type = type;\n\n    const responseBody = async function () {\n      const response = await fetch(this.url, this.options);\n\n      if (!response.ok) {\n        const message = `Error ${response.status}: ${response.statusText}`; // Not Found (for 404)\n        showToast(`API: ${message}`, 'error');\n\n        console.error(new FetchError(response, message));\n\n        return response.ok;\n      }\n\n      /*  different body for different responses */\n      return this.getTry(response);\n    };\n\n    /* Decorator */\n    query.define = Catch(responseBody);\n\n    return query;\n  }\n}\n\nexport default QueriesFactory.instance();\n","import Calendar from '../calendar';\n\nexport class User extends Calendar {\n  constructor(meetings, users) {\n    super(meetings, users);\n  }\n\n  canDeleteMeetings() {\n    return false;\n  }\n\n  canCreateMeetings() {\n    return false;\n  }\n}\n\nexport class Admin extends User {\n  constructor(meetings, users) {\n    super(meetings, users);\n  }\n\n  canDeleteMeetings() {\n    return true;\n  }\n\n  canCreateMeetings() {\n    return true;\n  }\n}\n","import query from '../../database';\nimport showToast from '../notification';\n\nexport default class Calendar {\n  element; //html element\n  subElements = {}; //html element, meetings\n  start = 10;\n  end = 18;\n  duration = 1;\n\n  onRemoveMeetingClick = async (event) => {\n    const chosenMeeting = event.target.closest('[data-meeting]');\n    const chosenMeetingId = chosenMeeting.dataset.meeting;\n    const chosenMeetingName = chosenMeeting.dataset.name;\n\n    const modal = confirm(\n      `Are you sure you want to delete '${chosenMeetingName}' event?`\n    );\n\n    if (modal) {\n      const response = await query.response('delete', chosenMeetingId);\n      const isResponseOK = await response.define();\n\n      if (isResponseOK) chosenMeeting.remove();\n    }\n  };\n\n  constructor(meetings, users) {\n    this.meetings = meetings;\n    this.users = users;\n\n    this.sessionUser = JSON.parse(sessionStorage.getItem('memberLoggedIn'));\n\n    this.render();\n  }\n\n  async render() {\n    const wrapper = document.createElement('div');\n    wrapper.innerHTML = this.getTable();\n\n    const element = wrapper.firstElementChild;\n    this.element = element;\n\n    if (this.meetings.length) this.renderMeetings(this.meetings);\n\n    this.subElements = this.getSubElements(this.element);\n\n    this.initEventListeners();\n\n    return this.element;\n  }\n\n  getSubElements(element = this.element) {\n    const elements = element.querySelectorAll('[data-meeting]');\n\n    return [...elements].reduce((accum, subElement) => {\n      accum[subElement.dataset.meeting] = subElement;\n\n      return accum;\n    }, {});\n  }\n\n  getTable() {\n    return `\n      <div class='calendar'>\n        ${this.getTableHeader()}\n        ${this.getTableBody()}\n        ${this.getTableFooter()}\n        <div aria-live=\"polite\" aria-atomic=\"true\" class=\"position-relative\">\n          <div class=\"toast-container position-fixed bottom-0 end-0 p-3\">\n\n          </div>\n        </div>\n      </div>`;\n  }\n\n  getTableFooter() {\n    return `<div class='calendar__footer'>\n      <div>\n        You are logged in as ${this.sessionUser.name} (${this.sessionUser.rights})\n      </div>\n      <button type='button' class='btn btn-outline-secondary' id='logOutButton'>\n        Log out\n      </button>\n    </div>`;\n  }\n\n  getTableHeader() {\n    return `\n      <div class='calendar__header'>\n        <div>\n          <h1>Calendar</h1>\n        </div>\n        <div class='calendar__header_handling'>\n            ${this.getMembersDropdown()}\n            ${this.getEventButton}\n        </div>\n      </div>\n    `;\n  }\n\n  getMembersDropdown() {\n    if (this.sessionUser.name === 'guest') {\n      return `\n      <div class='calendar__header_handling-dropdown'>\n        <select class='form-select form-select-lg' id='membersDropdown'>\n          <option value='All members'>All members</option>\n        </select>\n      </div>`;\n    }\n\n    return `\n    <div class='calendar__header_handling-dropdown'>\n      <select class='form-select form-select-lg' id='membersDropdown'>\n        <option value='All members'>All members</option>\n        ${this.membersList}\n      </select>\n    </div>`;\n  }\n\n  get membersList() {\n    return this.users\n      .map((user) => {\n        return `<option value='${user.data.name}' data-member='${user.data.name}'>${user.data.name}</option>`;\n      })\n      .join('');\n  }\n\n  get getEventButton() {\n    if (this.canCreateMeetings()) {\n      return `\n    <div class='calendar__header_handling-newEventCreatingButton'>\n      <a href='/meeting-planning-calendar/create-event'>\n        <button\n          type='submit'\n          name='newEvent'\n          class='btn btn-outline-dark'\n        >\n        New event +\n        </button>\n      </a>\n    </div>`;\n    }\n\n    return `\n    <div class='calendar__header_handling-newEventCreatingButton'>\n        <button\n          type='submit'\n          name='newEvent'\n          class='btn btn-outline-dark disabled'\n        >\n        New event +\n        </button>\n    </div>`;\n  }\n\n  getTableBody() {\n    return `<div class='calendar__table'>\n      <ul class='calendar__table-column' data-day='Name'>\n        <li class='calendar__table-column-header'>Name</li>\n        ${this.getTableHoursColumn()}\n      </ul>\n\n      <ul class='calendar__table-column' data-day='Mon'>\n        <li class='calendar__table-column-header'>Mon</li>\n        ${this.getTableColumn()}\n      </ul>\n\n      <ul class='calendar__table-column' data-day='Tue'>\n        <li class='calendar__table-column-header'>Tue</li>\n        ${this.getTableColumn()}\n      </ul>\n\n      <ul class='calendar__table-column' data-day='Wed'>\n        <li class='calendar__table-column-header'>Wed</li>\n        ${this.getTableColumn()}\n      </ul>\n\n      <ul class='calendar__table-column' data-day='Thu'>\n        <li class='calendar__table-column-header'>Thu</li>\n        ${this.getTableColumn()}\n      </ul>\n\n      <ul class='calendar__table-column' data-day='Fri'>\n        <li class='calendar__table-column-header'>Fri</li>\n        ${this.getTableColumn()}\n      </ul>\n    </div>`;\n  }\n\n  getTableHoursColumn() {\n    let a = [];\n\n    for (let i = this.start; i <= this.end; i = i + this.duration) {\n      a.push(`<li>${i}:00</li>`);\n    }\n\n    return a.join('');\n  }\n\n  getTableColumn() {\n    let a = [];\n\n    for (let i = this.start; i <= this.end; i = i + this.duration) {\n      a.push(\n        `<li\n          data-time='${i}:00'\n        ></li>`\n      );\n    }\n\n    return a.join('');\n  }\n\n  renderMeetings(meetings) {\n    const arr = [...meetings];\n    arr.map((meeting) => {\n      const currentColumn = this.element.querySelector(\n        `[data-day='${meeting.data.day}']`\n      );\n      const currentRow = currentColumn.querySelector(\n        `[data-time='${meeting.data.time}']`\n      );\n\n      if (this.canDeleteMeetings()) {\n        return (currentRow.innerHTML = `\n      <div data-meeting='${meeting.id}' data-name='${meeting.data.name}' style='visibility: visible'>\n        <a href='/meetings/${meeting.id}' class='calendar__table-column_meeting'>\n          ${meeting.data.name}\n        </a>\n        <button class='calendar__table-column_meeting_delete' data-delete='delete'>&times;</button>\n      </div>`);\n      }\n\n      return (currentRow.innerHTML = `\n      <div data-meeting='${meeting.id}' data-name='${meeting.data.name}' style='visibility: visible'>\n        <div class='calendar__table-column_meeting'>\n          ${meeting.data.name}\n        </div>\n      </div>`);\n    });\n  }\n\n  initEventListeners() {\n    // remove event from calendar\n    if (this.canDeleteMeetings()) {\n      const deleteButton = this.element.querySelectorAll('[data-delete]');\n      for (let button of deleteButton) {\n        button.addEventListener('pointerdown', this.onRemoveMeetingClick);\n      }\n    }\n\n    // filter events by team member\n    const membersDropdown = this.element.querySelector('#membersDropdown');\n    membersDropdown.addEventListener('change', () => {\n      const chosenMember = membersDropdown.value;\n      this.filterMeetings(chosenMember);\n    });\n\n    // log out from user session\n    const logOutButton = this.element.querySelector('#logOutButton');\n    logOutButton.addEventListener('click', () => {\n      sessionStorage.clear();\n      window.location.reload();\n    });\n  }\n\n  filterMeetings(chosenMember) {\n    if (!this.meetings.length)\n      return showToast('No events to filter', 'warning');\n\n    if (chosenMember === 'All members') {\n      for (let item of Object.keys(this.subElements)) {\n        this.subElements[item].style.visibility = 'visible';\n      }\n\n      return [...this.meetings];\n    }\n\n    const meetings = [...this.meetings];\n    const users = [...this.users];\n    const idOfChosenMember = users.find(\n      ({ data }) => data.name === chosenMember\n    ).id;\n\n    // get all meetings that must be disabled\n    const filteredMeetings = meetings\n      .filter((meeting) =>\n        meeting.data.members.every((member) => member.id !== idOfChosenMember)\n      )\n      .map((item) => item.id);\n\n    // insert style = 'display: visible' into all meetings\n    for (let item of Object.keys(this.subElements)) {\n      this.subElements[item].style.visibility = 'visible';\n    }\n\n    // insert style = 'display: none' into filteredÂ¸ meetings\n    for (let item of filteredMeetings) {\n      if (Object.keys(this.subElements).includes(item)) {\n        this.subElements[item].style.visibility = 'hidden';\n      }\n    }\n\n    return filteredMeetings;\n  }\n\n  destroy() {\n    this.element.remove();\n  }\n}\n","export default class LogInModal {\n  constructor(users) {\n    this.members = users;\n  }\n\n  get template() {\n    return `\n    <div class=\"modal fade modal-dialog\"  id=\"staticBackdrop\">\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\" id=\"staticBackdropLabel\">Who are You?</h5>\n          </div>\n          <div class=\"modal-body\">\n            <div class='calendar__header_handling-dropdown'>\n              <select class='form-select form-select-lg' id='membersDropdownModal'>\n                ${this.members\n                  .map((member) => {\n                    return `<option value='${member.data.name}' data-rights='${member.data.rights}'>${member.data.name} (${member.data.rights})</option>`;\n                  })\n                  .join('')}\n              </select>\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" id=\"submitRoleButton\">Confirm</button>\n          </div>\n        </div>\n      </div>\n    </div>`;\n  }\n}\n","export const members = [\n  { id: '0001', name: 'Polina', rights: 'admin' },\n  { id: '0002', name: 'Maria', rights: 'user' },\n  { id: '0003', name: 'Bob', rights: 'user' },\n  { id: '0004', name: 'Alex', rights: 'user' },\n];\n\n// users template to send to server\nexport const membersTemplate = [\n  { id: 0, data: { name: 'Polina', rights: 'admin' } },\n  { name: 'Polina', rights: 'admin' },\n  { name: 'Maria', rights: 'user' },\n  { name: 'Bob', rights: 'user' },\n  { name: 'Alex', rights: 'user' },\n];\n\nexport const noMembersMock = [\n  { id: 0, data: { name: 'guest', rights: 'user' } },\n];\n","import { User, Admin } from '../../components/userRoles';\nimport LogInModal from '../../components/logIn-modal';\nimport query from '../../database';\nimport { noMembersMock } from '../../fixtures-members';\n\nexport default class Page {\n  element; //html element\n  subElements = {}; //selected elements\n  components = {}; //imported initialized components\n  meetings = {};\n  users = {};\n\n  get template() {\n    return `\n      <div>\n        <div data-element=\"calendar\" id=\"calendarPage\">\n          <!-- Calendar component -->\n        </div>\n        <div aria-live=\"polite\" aria-atomic=\"true\" class=\"position-relative\">\n          <div class=\"toast-container position-fixed bottom-0 end-0 p-3\">\n\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  async render() {\n    const element = document.createElement('div');\n    element.innerHTML = this.template;\n\n    this.element = element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    // query data from database\n    const responseUsers = await query.response('get', 'users');\n    const responseEvents = await query.response('get', 'events');\n    this.users = (await responseUsers.define()) || noMembersMock;\n    this.meetings = (await responseEvents.define()) || [];\n\n    const getSessionUser = JSON.parse(sessionStorage.getItem('memberLoggedIn'));\n\n    if (getSessionUser) {\n      this.initComponents(getSessionUser.rights);\n      this.renderComponents();\n\n      return this.element;\n    }\n\n    this.modal();\n\n    return this.element;\n  }\n\n  // async sendUsersToServer() {\n  //   // post users to server\n  //   try {\n  //     const response = await fetch(`${BACKEND_URL}/${SYSTEM}/${ENTITY_USERS}`, {\n  //       method: 'POST',\n  //       headers: {\n  //         'Content-Type': 'application/json;charset=utf-8',\n  //       },\n  //       body: JSON.stringify({\n  //         data: JSON.stringify(membersTemplate[0]),\n  //       }),\n  //     });\n\n  //     const result = await response.status;\n  //     console.log(result);\n  //   } catch (error) {\n  //     console.log(error);\n  //   }\n  // }\n\n  modal() {\n    const logInModal = new LogInModal(this.users);\n    this.element.querySelector('#calendarPage').innerHTML = logInModal.template;\n\n    const myModal = new bootstrap.Modal(\n      this.element.querySelector('#staticBackdrop'),\n      {}\n    );\n\n    myModal.show();\n\n    const submitRoleButton = this.element.querySelector('#submitRoleButton');\n    submitRoleButton.addEventListener('pointerdown', this.onDefineRights);\n  }\n\n  onDefineRights = () => {\n    // set logged in member as default selected member in calendar dropdown\n    const getMembers = this.element.querySelector('#membersDropdownModal');\n\n    const getName = getMembers.value;\n    const getRights = getMembers.options[getMembers.selectedIndex].getAttribute(\n      'data-rights'\n    );\n\n    const memberLoggedInData = { name: getName, rights: getRights };\n\n    // set session user rights\n    sessionStorage.setItem(\n      'memberLoggedIn',\n      JSON.stringify(memberLoggedInData)\n    );\n\n    document.querySelector('#staticBackdrop').remove();\n    document.querySelector('.modal-backdrop').remove();\n\n    this.initComponents(getRights);\n    this.renderComponents();\n  };\n\n  getSubElements(element) {\n    const elements = element.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((accum, subElement) => {\n      accum[subElement.dataset.element] = subElement;\n\n      return accum;\n    }, {});\n  }\n\n  initComponents(rights) {\n    if (rights === 'admin') {\n      const calendar = new Admin(this.meetings, this.users);\n      return (this.components.calendar = calendar);\n    }\n\n    const calendar = new User(this.meetings, this.users);\n    return (this.components.calendar = calendar);\n  }\n\n  renderComponents() {\n    Object.keys(this.components).forEach((component) => {\n      const root = this.subElements[component];\n      const { element } = this.components[component];\n\n      root.append(element);\n    });\n  }\n\n  destroy() {\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n  }\n}\n"],"sourceRoot":""}